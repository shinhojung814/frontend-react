{"ast":null,"code":"var _jsxFileName = \"/Users/shinhojung/git/raising-alien-creatures/client/src/pages/NewAlien/index.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport * as actions from \"../../Redux/actions\";\nimport { useNavigate } from \"react-router\";\nimport { useParams } from \"react-router-dom\";\nimport styles from \"./index.module.css\";\nimport api from \"../../apis\";\nimport AlienSlide from \"./AlienSlide\";\nimport AlienInfo from \"./AlienInfo\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function NewAlien(props) {\n  _s();\n\n  const {\n    challengeId\n  } = useParams();\n  const {\n    user\n  } = useSelector(({\n    user\n  }) => ({\n    user: user.user\n  })); // console.log(\"New Challenge params\", params);\n\n  const [authCount, setAuthCount] = useState(\"\"); // 생명체 정보\n\n  const [alienName, setAlienName] = useState(\"\");\n  const [alienNumber, setAlienNumber] = useState(0);\n  const [alienCategory, setAlienCategory] = useState({\n    type: \"fish\",\n    angle: 60,\n    divider: 6\n  }); // 인증 요일\n\n  const [checkDay, setCheckDay] = useState([]); // validation\n\n  const [creAlienMessage, setCreAlienMessage] = useState(null); // 링크 이동\n\n  const navigate = useNavigate(); // 팝업\n\n  const dispatch = useDispatch(); // 중복 생성 요청 방지\n\n  const [alienClicked, setAlienClicked] = useState(false); // 기본 생명체 번호 계산\n\n  let aNumber = alienNumber;\n\n  if (aNumber >= 0) {\n    aNumber = aNumber % alienCategory.divider;\n\n    while (aNumber < 0) {\n      aNumber += alienCategory.divider;\n    }\n  } else {\n    aNumber %= alienCategory.divider;\n\n    while (aNumber < 0) {\n      aNumber += alienCategory.divider;\n    }\n\n    if (aNumber === -0) {\n      aNumber = 0;\n    }\n  }\n\n  if (alienCategory.type === \"fish\") {\n    aNumber += 10;\n  } else if (alienCategory.type === \"seal\") {\n    aNumber += 20;\n  } else if (alienCategory.type === \"puffish\") {\n    aNumber += 30;\n  }\n\n  useEffect(() => {\n    // cntOfWeek\n    try {\n      const getChalData = async () => {\n        // 본 챌린지에 참가중인지 확인\n        let participating;\n\n        if (user.login && user.challenges) {\n          participating = user.challenges.findIndex(c => c.id === Number(challengeId)) !== -1;\n        }\n\n        if (!user.login || participating) return;\n        let res = await api.get(`/challenge/totalAuthCnt/${challengeId}`);\n\n        if (res.data.result === \"success\") {\n          setAuthCount(res.data.times_per_week);\n        } else {// TODO: error handling 필요한가?\n        }\n      };\n\n      getChalData();\n    } catch (err) {\n      console.error(\"fetchData fail\", err);\n    }\n  }, [challengeId, user.login, user.challenges]); // validation\n\n  function validateCreAlien(alienName, checkDay, authCount) {\n    if (!alienName) {\n      setCreAlienMessage(\"생명체 이름을 지어주세요!\");\n      return false;\n    }\n\n    if (!checkDay.length) {\n      setCreAlienMessage(\"인증 요일을 선택해주세요!\");\n      return false;\n    }\n\n    if (checkDay.length !== authCount) {\n      setCreAlienMessage(\"인증 횟수를 확인해주세요!\");\n      return false;\n    }\n\n    setCreAlienMessage(null);\n    return true;\n  } // 생명체 생성 event\n\n\n  const handleSubmit = e => {\n    // e.preventDefault();\n    // validation check\n    if (alienClicked) return;\n    if (!validateCreAlien(alienName, checkDay, authCount)) return;\n    setAlienClicked(true);\n    postCreateAlien();\n  }; // 캐릭터 선택탭\n\n\n  const handleTap = e => {\n    setAlienNumber(0);\n\n    if (e === \"fish\") {\n      setAlienCategory({\n        type: \"fish\",\n        angle: 60,\n        divider: 6\n      });\n    } else if (e === \"seal\") {\n      setAlienCategory({\n        type: \"seal\",\n        angle: 90,\n        divider: 4\n      });\n    } else if (e === \"puffish\") {\n      setAlienCategory({\n        type: \"puffish\",\n        angle: 90,\n        divider: 4\n      });\n    } else return;\n  }; // Alien 정보 api 보내기\n\n\n  const postCreateAlien = async () => {\n    let createAlienData = {\n      challenge_id: challengeId,\n      alien_name: alienName,\n      image_url: aNumber,\n      times_per_week: authCount,\n      sun: Number(checkDay.includes(\"sun\")),\n      mon: Number(checkDay.includes(\"mon\")),\n      tue: Number(checkDay.includes(\"tue\")),\n      wed: Number(checkDay.includes(\"wed\")),\n      thu: Number(checkDay.includes(\"thu\")),\n      fri: Number(checkDay.includes(\"fri\")),\n      sat: Number(checkDay.includes(\"sat\"))\n    };\n    const response = await api.post(\"/alien/create\", createAlienData);\n    console.log(\"res\", response);\n\n    if (response.data.result === \"access_deny_full\") {\n      // 1) 종류 2) 메세지 문구 3) SUCC or FAIL에 따른 아이콘 변경 4) callback함수(사실 여기선 별 효과 없음)\n      dispatch(actions.setPopupModal(\"CREATE_ALIEN\", \"방의 정원이 가득 찼습니다 !\", \"FAIL\", () => {\n        navigate(`/challenge/${challengeId}/room`);\n      }));\n      return;\n    }\n\n    if (response.data.result === \"fail_already_participant\") {\n      dispatch(actions.setPopupModal(\"CREATE_ALIEN\", \"이미 참가중인 챌린지입니다 !\", \"FAIL\", () => {\n        navigate(`/challenge/${challengeId}/room`);\n      }));\n      return;\n    }\n\n    dispatch(actions.setPopupModal(\"CREATE_ALIEN\", \"생명체가 생성되었습니다 !\", \"SUCC\", () => {\n      navigate(`/challenge/${challengeId}/room`);\n    }));\n    dispatch(actions.joinChallenge({\n      id: parseInt(challengeId)\n    }));\n  };\n\n  console.log(\"alienClicked\", alienClicked); // console.log(\"checkDay\", checkDay);\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: styles.body,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container md:w-2/5 md:min-w-max\",\n      children: [/*#__PURE__*/_jsxDEV(AlienInfo, {\n        setAlienName: setAlienName,\n        authCount: authCount,\n        checkDay: checkDay,\n        setCheckDay: setCheckDay\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container border-gray-500 w-1/2 px-3 py-3 mb-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"ul\", {\n          className: \"relative md:px-1 py-1 min-w-max\",\n          children: [/*#__PURE__*/_jsxDEV(\"li\", {\n            className: \"\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              className: alienCategory.type === \"fish\" ? \"bg-white inline-block border-gray-400 border-l-2 border-t-2 border-r-2 rounded-t py-2 px-4 text-indigo-700 font-semibold\" : \"bg-white inline-block py-2 px-4 text-indigo-700 font-semibold hover:text-red-600\",\n              onClick: () => handleTap(\"fish\"),\n              children: \"\\uBFE1\\uC5B4\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 198,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 197,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            className: \"\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              className: alienCategory.type === \"seal\" ? \"bg-white inline-block border-gray-400 border-l-2 border-t-2 border-r-2 rounded-t py-2 px-4 text-indigo-700  font-semibold\" : \"bg-white inline-block py-2 px-4 text-indigo-700  font-semibold hover:text-red-600\",\n              onClick: () => handleTap(\"seal\"),\n              children: \"\\uBB3C\\uAC1C\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 210,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 209,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            className: \"\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              className: alienCategory.type === \"puffish\" ? \"bg-white inline-block border-gray-400 border-l-2 border-t-2 border-r-2 rounded-t py-2 px-4 text-indigo-700  font-semibold\" : \"bg-white inline-block py-2 px-4 text-indigo-700 font-semibold hover:text-red-600\",\n              onClick: () => handleTap(\"puffish\"),\n              children: \"\\uBCF5\\uC5B4\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 222,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 221,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"rounded border-1 border-gray-400 md:p-5 md:w-full w-min md:min-w-max pl-0.5\",\n          children: /*#__PURE__*/_jsxDEV(AlienSlide, {\n            alienNumber: alienNumber,\n            setAlienNumber: setAlienNumber,\n            alienCategory: alienCategory\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 236,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 235,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"pb-3 px-3 text-red-500 font-semibold text-center\",\n        children: creAlienMessage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex justify-center pb-5\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"border py-1 px-3 rounded-lg shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 text-font-semibold\",\n          onClick: handleSubmit,\n          children: \"\\uC0DD\\uBA85\\uCCB4 \\uC0DD\\uC131\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 248,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 247,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 186,\n    columnNumber: 5\n  }, this);\n}\n\n_s(NewAlien, \"lbhNkZUORmIoSqyb7t10O7KE2SM=\", false, function () {\n  return [useParams, useSelector, useNavigate, useDispatch];\n});\n\n_c = NewAlien;\n\nvar _c;\n\n$RefreshReg$(_c, \"NewAlien\");","map":{"version":3,"sources":["/Users/shinhojung/git/raising-alien-creatures/client/src/pages/NewAlien/index.js"],"names":["React","useState","useEffect","useDispatch","useSelector","actions","useNavigate","useParams","styles","api","AlienSlide","AlienInfo","NewAlien","props","challengeId","user","authCount","setAuthCount","alienName","setAlienName","alienNumber","setAlienNumber","alienCategory","setAlienCategory","type","angle","divider","checkDay","setCheckDay","creAlienMessage","setCreAlienMessage","navigate","dispatch","alienClicked","setAlienClicked","aNumber","getChalData","participating","login","challenges","findIndex","c","id","Number","res","get","data","result","times_per_week","err","console","error","validateCreAlien","length","handleSubmit","e","postCreateAlien","handleTap","createAlienData","challenge_id","alien_name","image_url","sun","includes","mon","tue","wed","thu","fri","sat","response","post","log","setPopupModal","joinChallenge","parseInt","body"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport * as actions from \"../../Redux/actions\";\nimport { useNavigate } from \"react-router\";\nimport { useParams } from \"react-router-dom\";\nimport styles from \"./index.module.css\";\nimport api from \"../../apis\";\nimport AlienSlide from \"./AlienSlide\";\nimport AlienInfo from \"./AlienInfo\";\n\nexport default function NewAlien(props) {\n  const { challengeId } = useParams();\n  const { user } = useSelector(({ user }) => ({ user: user.user }));\n  // console.log(\"New Challenge params\", params);\n  const [authCount, setAuthCount] = useState(\"\");\n  // 생명체 정보\n  const [alienName, setAlienName] = useState(\"\");\n  const [alienNumber, setAlienNumber] = useState(0);\n  const [alienCategory, setAlienCategory] = useState({\n    type: \"fish\",\n    angle: 60,\n    divider: 6,\n  });\n  // 인증 요일\n  const [checkDay, setCheckDay] = useState([]);\n\n  // validation\n  const [creAlienMessage, setCreAlienMessage] = useState(null);\n  // 링크 이동\n  const navigate = useNavigate();\n  // 팝업\n  const dispatch = useDispatch();\n  // 중복 생성 요청 방지\n  const [alienClicked, setAlienClicked] = useState(false);\n\n  // 기본 생명체 번호 계산\n  let aNumber = alienNumber;\n  if (aNumber >= 0) {\n    aNumber = aNumber % alienCategory.divider;\n    while (aNumber < 0) {\n      aNumber += alienCategory.divider;\n    }\n  } else {\n    aNumber %= alienCategory.divider;\n    while (aNumber < 0) {\n      aNumber += alienCategory.divider;\n    }\n    if (aNumber === -0) {\n      aNumber = 0;\n    }\n  }\n  if (alienCategory.type === \"fish\") {\n    aNumber += 10;\n  } else if (alienCategory.type === \"seal\") {\n    aNumber += 20;\n  } else if (alienCategory.type === \"puffish\") {\n    aNumber += 30;\n  }\n\n  useEffect(() => {\n    // cntOfWeek\n    try {\n      const getChalData = async () => {\n        // 본 챌린지에 참가중인지 확인\n        let participating;\n        if (user.login && user.challenges) {\n          participating =\n            user.challenges.findIndex((c) => c.id === Number(challengeId)) !==\n            -1;\n        }\n        if (!user.login || participating) return;\n        let res = await api.get(`/challenge/totalAuthCnt/${challengeId}`);\n        if (res.data.result === \"success\") {\n          setAuthCount(res.data.times_per_week);\n        } else {\n          // TODO: error handling 필요한가?\n        }\n      };\n      getChalData();\n    } catch (err) {\n      console.error(\"fetchData fail\", err);\n    }\n  }, [challengeId, user.login, user.challenges]);\n\n  // validation\n  function validateCreAlien(alienName, checkDay, authCount) {\n    if (!alienName) {\n      setCreAlienMessage(\"생명체 이름을 지어주세요!\");\n      return false;\n    }\n    if (!checkDay.length) {\n      setCreAlienMessage(\"인증 요일을 선택해주세요!\");\n      return false;\n    }\n    if (checkDay.length !== authCount) {\n      setCreAlienMessage(\"인증 횟수를 확인해주세요!\");\n      return false;\n    }\n    setCreAlienMessage(null);\n    return true;\n  }\n  // 생명체 생성 event\n  const handleSubmit = (e) => {\n    // e.preventDefault();\n    // validation check\n    if (alienClicked) return;\n    if (!validateCreAlien(alienName, checkDay, authCount)) return;\n    setAlienClicked(true);\n    postCreateAlien();\n  };\n  // 캐릭터 선택탭\n  const handleTap = (e) => {\n    setAlienNumber(0);\n    if (e === \"fish\") {\n      setAlienCategory({ type: \"fish\", angle: 60, divider: 6 });\n    } else if (e === \"seal\") {\n      setAlienCategory({ type: \"seal\", angle: 90, divider: 4 });\n    } else if (e === \"puffish\") {\n      setAlienCategory({ type: \"puffish\", angle: 90, divider: 4 });\n    } else return;\n  };\n\n  // Alien 정보 api 보내기\n  const postCreateAlien = async () => {\n    let createAlienData = {\n      challenge_id: challengeId,\n      alien_name: alienName,\n      image_url: aNumber,\n      times_per_week: authCount,\n      sun: Number(checkDay.includes(\"sun\")),\n      mon: Number(checkDay.includes(\"mon\")),\n      tue: Number(checkDay.includes(\"tue\")),\n      wed: Number(checkDay.includes(\"wed\")),\n      thu: Number(checkDay.includes(\"thu\")),\n      fri: Number(checkDay.includes(\"fri\")),\n      sat: Number(checkDay.includes(\"sat\")),\n    };\n\n    const response = await api.post(\"/alien/create\", createAlienData);\n    console.log(\"res\", response);\n    if (response.data.result === \"access_deny_full\") {\n      // 1) 종류 2) 메세지 문구 3) SUCC or FAIL에 따른 아이콘 변경 4) callback함수(사실 여기선 별 효과 없음)\n      dispatch(\n        actions.setPopupModal(\n          \"CREATE_ALIEN\",\n          \"방의 정원이 가득 찼습니다 !\",\n          \"FAIL\",\n          () => {\n            navigate(`/challenge/${challengeId}/room`);\n          }\n        )\n      );\n      return;\n    }\n\n    if (response.data.result === \"fail_already_participant\") {\n      dispatch(\n        actions.setPopupModal(\n          \"CREATE_ALIEN\",\n          \"이미 참가중인 챌린지입니다 !\",\n          \"FAIL\",\n          () => {\n            navigate(`/challenge/${challengeId}/room`);\n          }\n        )\n      );\n      return;\n    }\n\n    dispatch(\n      actions.setPopupModal(\n        \"CREATE_ALIEN\",\n        \"생명체가 생성되었습니다 !\",\n        \"SUCC\",\n        () => {\n          navigate(`/challenge/${challengeId}/room`);\n        }\n      )\n    );\n    dispatch(actions.joinChallenge({ id: parseInt(challengeId) }));\n  };\n\n  console.log(\"alienClicked\", alienClicked);\n  // console.log(\"checkDay\", checkDay);\n  return (\n    <div className={styles.body}>\n      <div className=\"container md:w-2/5 md:min-w-max\">\n        <AlienInfo\n          setAlienName={setAlienName}\n          authCount={authCount}\n          checkDay={checkDay}\n          setCheckDay={setCheckDay}\n        />\n\n        <div className=\"container border-gray-500 w-1/2 px-3 py-3 mb-3\">\n          <ul className=\"relative md:px-1 py-1 min-w-max\">\n            <li className=\"\">\n              <button\n                className={\n                  alienCategory.type === \"fish\"\n                    ? \"bg-white inline-block border-gray-400 border-l-2 border-t-2 border-r-2 rounded-t py-2 px-4 text-indigo-700 font-semibold\"\n                    : \"bg-white inline-block py-2 px-4 text-indigo-700 font-semibold hover:text-red-600\"\n                }\n                onClick={() => handleTap(\"fish\")}\n              >\n                뿡어\n              </button>\n            </li>\n            <li className=\"\">\n              <button\n                className={\n                  alienCategory.type === \"seal\"\n                    ? \"bg-white inline-block border-gray-400 border-l-2 border-t-2 border-r-2 rounded-t py-2 px-4 text-indigo-700  font-semibold\"\n                    : \"bg-white inline-block py-2 px-4 text-indigo-700  font-semibold hover:text-red-600\"\n                }\n                onClick={() => handleTap(\"seal\")}\n              >\n                물개\n              </button>\n            </li>\n            <li className=\"\">\n              <button\n                className={\n                  alienCategory.type === \"puffish\"\n                    ? \"bg-white inline-block border-gray-400 border-l-2 border-t-2 border-r-2 rounded-t py-2 px-4 text-indigo-700  font-semibold\"\n                    : \"bg-white inline-block py-2 px-4 text-indigo-700 font-semibold hover:text-red-600\"\n                }\n                onClick={() => handleTap(\"puffish\")}\n              >\n                복어\n              </button>\n            </li>\n          </ul>\n\n          <div className=\"rounded border-1 border-gray-400 md:p-5 md:w-full w-min md:min-w-max pl-0.5\">\n            <AlienSlide\n              alienNumber={alienNumber}\n              setAlienNumber={setAlienNumber}\n              alienCategory={alienCategory}\n            />\n          </div>\n        </div>\n\n        <div className=\"pb-3 px-3 text-red-500 font-semibold text-center\">\n          {creAlienMessage}\n        </div>\n        <div className=\"flex justify-center pb-5\">\n          <button\n            className=\"border py-1 px-3 rounded-lg shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 text-font-semibold\"\n            onClick={handleSubmit}\n          >\n            생명체 생성\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}