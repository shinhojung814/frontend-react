{"ast":null,"code":"var _jsxFileName = \"/Users/shinhojung/git/raising-alien-creatures/client/src/pages/MultiAquarium/MultiField/index.js\";\nimport React, { Component } from \"react\";\nimport Canvas from \"./Canvas\";\nimport aquarium from \"../../../shared\"; // import * as socket from \"../../../apis/socket\";\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default class Field extends Component {\n  constructor(...args) {\n    super(...args);\n    this.BG_COLORSET = {\n      sunset: [// https://www.color-hex.com/color-palette/40131\n      `rgba(238,175,97,1)`, `rgba(251,144,98,1)`, `rgba(238,93,108,1)`, `rgba(206,73,147,1)`],\n      space: [// https://www.color-hex.com/color-palette/35848\n      `rgba(5,55,123,1)`, `rgba(4,44,98,1)`, `rgba(3,33,74,1)`, `rgba(1,11,25,1)`],\n      myRoom: [`rgba(161,226,255,1)`, `rgba(23,202,241,1)`, `rgba(9,142,180,1)`, `rgba(3,107,129,1)`]\n    };\n\n    this.draw = (ctx, frameCnt, mouseObj) => {\n      // console.log(mouseObj);\n      let cvsWidth = ctx.canvas.width;\n      let cvsHeight = ctx.canvas.height;\n      ctx.save();\n      ctx.clearRect(0, 0, cvsWidth, cvsHeight);\n      const room = aquarium.getCurrentRoom();\n\n      if (room && room.fieldState) {\n        const {\n          monsters\n        } = room.fieldState; // console.log(111, room.usersOnRoom);\n        // draw background\n\n        let lingrad = ctx.createLinearGradient(0, 0, 0, cvsHeight);\n        let colorset;\n\n        if (room.roomId.includes('user')) {\n          colorset = this.BG_COLORSET[\"myRoom\"];\n        } else {\n          colorset = this.BG_COLORSET[\"space\"];\n        }\n\n        let pcts = room.camera.getGradientPct();\n        lingrad.addColorStop(0, colorset[0]);\n        lingrad.addColorStop(pcts[0], colorset[1]);\n        lingrad.addColorStop(pcts[1], colorset[2]);\n        lingrad.addColorStop(1, colorset[3]);\n        lingrad.addColorStop(0, colorset[0]);\n        lingrad.addColorStop(pcts[0], colorset[1]);\n        lingrad.addColorStop(pcts[1], colorset[2]);\n        lingrad.addColorStop(1, colorset[3]);\n        ctx.fillStyle = lingrad;\n        ctx.fillRect(0, 0, cvsWidth, cvsHeight); // translate location\n\n        const {\n          center\n        } = room.camera;\n        room.camera.run();\n        let transX = center.x;\n        let transY = center.y;\n        ctx.translate(cvsWidth / 2 - transX, cvsHeight / 2 - transY);\n        let mouseX = mouseObj.deltaXfromCenter + transX;\n        let mouseY = mouseObj.deltaYfromCenter + transY;\n        let selectedMonster = null; // draw central planet\n\n        ctx.beginPath();\n        ctx.arc(0, room.camera.getCanvasPlanetSize(400), room.camera.getCanvasPlanetSize(400), 0, Math.PI * 2);\n        var grd = ctx.createRadialGradient(100, 50, 0, 90, 60, 1000);\n\n        if (room.roomId.includes('user')) {\n          grd.addColorStop(0, \"#e3f6fa\");\n          grd.addColorStop(0.25, \"#86e3f7\");\n          grd.addColorStop(0.5, \"#1c9fba\");\n          grd.addColorStop(1, \"#0b6f84\");\n        } else {\n          grd.addColorStop(0, \"#f0c0ff\");\n          grd.addColorStop(0.25, \"#9048f0\");\n          grd.addColorStop(0.5, \"#6018c0\");\n          grd.addColorStop(1, \"black\");\n        }\n\n        ctx.fillStyle = grd;\n        ctx.fill(); // draw monster\n        // TODO: monster들의 순서 (누가 위에 놓일 것인지 여부) 처리 필요\n\n        for (const monId in monsters) {\n          let {\n            location,\n            size\n          } = monsters[monId];\n          let x = room.camera.getCanvasSize(location.x);\n          let y = room.camera.getCanvasSize(location.y);\n          size = room.camera.getCanvasSize(size) / 2; // if (isUserOnRoom) console.log(x, y);\n\n          if (mouseObj.clicked && !selectedMonster && (x - mouseX) ** 2 + (y - mouseY) ** 2 < size ** 2) {\n            // console.log(monId);\n            selectedMonster = monId;\n            this.props.handleSelectAlien(monId);\n          }\n\n          monsters[monId].display(ctx, frameCnt, room); // if (isUserOnRoom) {\n          //   ctx.beginPath();\n          //   ctx.arc(x, y, 8, 0, Math.PI * 2);\n          //   ctx.fillStyle = \"tomato\";\n          //   ctx.fill();\n          // }\n        }\n      }\n\n      ctx.restore();\n    };\n  }\n\n  render() {\n    const room = aquarium.getCurrentRoom();\n\n    if (!!room) {\n      return /*#__PURE__*/_jsxDEV(Canvas, {\n        draw: this.draw,\n        onMouseDown: room.camera.onMouseDown,\n        onMouseMove: room.camera.onMouseMove,\n        onMouseUp: room.camera.onMouseUp,\n        onTouchStart: room.camera.onTouchStart,\n        onTouchMove: room.camera.onTouchMove,\n        onTouchEnd: room.camera.onTouchEnd,\n        onWheel: room.camera.onWheel,\n        onResize: room.camera.onResize\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 9\n      }, this);\n    } else {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"\\uB85C\\uB529\\uC911...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 14\n      }, this);\n    }\n  }\n\n}","map":{"version":3,"sources":["/Users/shinhojung/git/raising-alien-creatures/client/src/pages/MultiAquarium/MultiField/index.js"],"names":["React","Component","Canvas","aquarium","Field","BG_COLORSET","sunset","space","myRoom","draw","ctx","frameCnt","mouseObj","cvsWidth","canvas","width","cvsHeight","height","save","clearRect","room","getCurrentRoom","fieldState","monsters","lingrad","createLinearGradient","colorset","roomId","includes","pcts","camera","getGradientPct","addColorStop","fillStyle","fillRect","center","run","transX","x","transY","y","translate","mouseX","deltaXfromCenter","mouseY","deltaYfromCenter","selectedMonster","beginPath","arc","getCanvasPlanetSize","Math","PI","grd","createRadialGradient","fill","monId","location","size","getCanvasSize","clicked","props","handleSelectAlien","display","restore","render","onMouseDown","onMouseMove","onMouseUp","onTouchStart","onTouchMove","onTouchEnd","onWheel","onResize"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport Canvas from \"./Canvas\";\n\nimport aquarium from \"../../../shared\";\n\n// import * as socket from \"../../../apis/socket\";\n\nexport default class Field extends Component {\n  BG_COLORSET = {\n    sunset: [\n      // https://www.color-hex.com/color-palette/40131\n      `rgba(238,175,97,1)`,\n      `rgba(251,144,98,1)`,\n      `rgba(238,93,108,1)`,\n      `rgba(206,73,147,1)`,\n    ],\n    space: [\n      // https://www.color-hex.com/color-palette/35848\n      `rgba(5,55,123,1)`,\n      `rgba(4,44,98,1)`,\n      `rgba(3,33,74,1)`,\n      `rgba(1,11,25,1)`,\n    ],\n    myRoom: [\n      `rgba(161,226,255,1)`,\n      `rgba(23,202,241,1)`,\n      `rgba(9,142,180,1)`,\n      `rgba(3,107,129,1)`,\n    ],\n  };\n\n  // roomId: \"user-261\"\n  draw = (ctx, frameCnt, mouseObj) => {\n    // console.log(mouseObj);\n    let cvsWidth = ctx.canvas.width;\n    let cvsHeight = ctx.canvas.height;\n    ctx.save();\n    ctx.clearRect(0, 0  , cvsWidth, cvsHeight);\n\n    const room = aquarium.getCurrentRoom();\n    if (room && room.fieldState) {\n      const { monsters } = room.fieldState;\n      // console.log(111, room.usersOnRoom);\n      // draw background\n      let lingrad = ctx.createLinearGradient(0, 0, 0, cvsHeight);\n      let colorset;\n      if (room.roomId.includes('user')){\n        colorset = this.BG_COLORSET[\"myRoom\"];\n      }\n      else{\n        colorset = this.BG_COLORSET[\"space\"];\n      }\n      let pcts = room.camera.getGradientPct();\n      lingrad.addColorStop(0, colorset[0]);\n      lingrad.addColorStop(pcts[0], colorset[1]);\n      lingrad.addColorStop(pcts[1], colorset[2]);\n      lingrad.addColorStop(1, colorset[3]);\n      lingrad.addColorStop(0, colorset[0]);\n      lingrad.addColorStop(pcts[0], colorset[1]);\n      lingrad.addColorStop(pcts[1], colorset[2]);\n      lingrad.addColorStop(1, colorset[3]);\n      ctx.fillStyle = lingrad;\n      ctx.fillRect(0, 0, cvsWidth, cvsHeight);\n\n      // translate location\n      const { center } = room.camera;\n      room.camera.run();\n      let transX = center.x;\n      let transY = center.y;\n      ctx.translate(cvsWidth / 2 - transX, cvsHeight / 2 - transY);\n\n      let mouseX = mouseObj.deltaXfromCenter + transX;\n      let mouseY = mouseObj.deltaYfromCenter + transY;\n      let selectedMonster = null;\n\n      // draw central planet\n      ctx.beginPath();\n      ctx.arc(\n        0,\n        room.camera.getCanvasPlanetSize(400),\n        room.camera.getCanvasPlanetSize(400),\n        0,\n        Math.PI * 2\n      );\n\n      var grd = ctx.createRadialGradient(100, 50, 0, 90, 60, 1000);\n      if (room.roomId.includes('user')){\n        grd.addColorStop(0, \"#e3f6fa\");\n        grd.addColorStop(0.25, \"#86e3f7\");\n        grd.addColorStop(0.5, \"#1c9fba\");\n        grd.addColorStop(1, \"#0b6f84\");\n      }\n      else{\n        grd.addColorStop(0, \"#f0c0ff\");\n        grd.addColorStop(0.25, \"#9048f0\");\n        grd.addColorStop(0.5, \"#6018c0\");\n        grd.addColorStop(1, \"black\");\n      }\n      ctx.fillStyle = grd;\n      ctx.fill();\n\n      // draw monster\n      // TODO: monster들의 순서 (누가 위에 놓일 것인지 여부) 처리 필요\n      for (const monId in monsters) {\n        let { location, size } = monsters[monId];\n        let x = room.camera.getCanvasSize(location.x);\n        let y = room.camera.getCanvasSize(location.y);\n        size = room.camera.getCanvasSize(size) / 2;\n        // if (isUserOnRoom) console.log(x, y);\n        if (\n          mouseObj.clicked &&\n          !selectedMonster &&\n          (x - mouseX) ** 2 + (y - mouseY) ** 2 < size ** 2\n        ) {\n          // console.log(monId);\n          selectedMonster = monId;\n          this.props.handleSelectAlien(monId);\n        }\n\n        monsters[monId].display(ctx, frameCnt, room);\n\n        // if (isUserOnRoom) {\n        //   ctx.beginPath();\n        //   ctx.arc(x, y, 8, 0, Math.PI * 2);\n        //   ctx.fillStyle = \"tomato\";\n        //   ctx.fill();\n        // }\n      }\n    }\n    ctx.restore();\n  };\n\n  render() {\n    const room = aquarium.getCurrentRoom();\n    if (!!room) {\n      return (\n        <Canvas\n          draw={this.draw}\n          onMouseDown={room.camera.onMouseDown}\n          onMouseMove={room.camera.onMouseMove}\n          onMouseUp={room.camera.onMouseUp}\n          onTouchStart={room.camera.onTouchStart}\n          onTouchMove={room.camera.onTouchMove}\n          onTouchEnd={room.camera.onTouchEnd}\n          onWheel={room.camera.onWheel}\n          onResize={room.camera.onResize}\n        />\n      );\n    } else {\n      return <div>로딩중...</div>;\n    }\n  }\n}\n"]},"metadata":{},"sourceType":"module"}