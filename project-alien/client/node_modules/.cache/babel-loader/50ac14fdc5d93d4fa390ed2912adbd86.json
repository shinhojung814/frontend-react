{"ast":null,"code":"import io from \"socket.io-client\";\nlet socket = null;\nconst SOCKET_URL = process.env.NODE_ENV === \"production\" ? \"/\" : \"http://localhost:5001\";\nexport function init(userinfo) {\n  socket = io(SOCKET_URL);\n  console.log(\"[socket] init\", SOCKET_URL);\n  socket.on(\"connect\", () => {\n    console.log(\"[socket] connect\");\n  });\n\n  if (socket && userinfo.id && userinfo.challenges) {\n    console.log(\"[socket] join\", userinfo.id, userinfo.challenges);\n    socket.emit(\"join\", userinfo);\n  }\n}\nexport function disconnect(roomId) {\n  if (!socket) return;\n  console.log(\"[socket] disconnect\", roomId);\n  socket.disconnect();\n}\nexport function sendMessage(message) {\n  if (!socket) return;\n  socket.emit(\"send_message\", message);\n}\nexport function receiveMessage(handler) {\n  console.log(\"[socket] receiveMessage\");\n  if (!socket) return;\n  socket.on(\"receive_message\", handler);\n}\nexport function blockMessage() {\n  if (!socket) return;\n  console.log(\"[socket] blockMessage\");\n  socket.off(\"receive_message\");\n}\nexport function emitAuthRequest(info) {\n  if (!socket) return;\n  console.log(\"[socket] emitAuthRequest\");\n  socket.emit(\"auth_request\", info);\n}\nexport function onAuthRequest(handler) {\n  if (!socket) return;\n  console.log(\"[socket] onAuthRequest\");\n  socket.on(\"auth_request\", handler);\n}\nexport function emitAuthApproval(info) {\n  if (!socket) return;\n  console.log(\"[socket] emitAuthApproval\");\n  socket.emit(\"auth_approval\", info);\n}\nexport function onAuthApproval(handler) {\n  if (!socket) return;\n  console.log(\"[socket] onAuthApproval\");\n  socket.on(\"auth_approval\", handler);\n} // TODO: 새로운 챌린지 참가, 졸업, 타이머에 의해 죽었을 때 처리\n\nexport function emitJoin(userinfo) {\n  if (!socket) return;\n  socket.emit(\"join_challenge\", userinfo);\n}\nexport function onJoin(handler) {\n  if (!socket) return;\n  socket.on(\"join_challenge\", handler);\n}\nexport function emitGraduate(userinfo) {\n  if (!socket) return;\n  socket.emit(\"graduate_challenge\", userinfo);\n}\nexport function onGraduate(handler) {\n  if (!socket) return;\n  socket.on(\"graduate_challenge\", handler);\n} // // // // // // // // // // // // // // // // // // // //\n// // // // // // // to update // // // // // // // // // //\n\nexport function usersOnRoom(handler) {\n  if (!socket) return;\n  console.log(\"[socket] usersOnRoom\");\n  socket.on(\"usersOnRoom\", handler);\n}","map":{"version":3,"sources":["/Users/shinhojung/git/raising-alien-creatures/client/src/apis/socket.js"],"names":["io","socket","SOCKET_URL","process","env","NODE_ENV","init","userinfo","console","log","on","id","challenges","emit","disconnect","roomId","sendMessage","message","receiveMessage","handler","blockMessage","off","emitAuthRequest","info","onAuthRequest","emitAuthApproval","onAuthApproval","emitJoin","onJoin","emitGraduate","onGraduate","usersOnRoom"],"mappings":"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","sourcesContent":["import io from \"socket.io-client\";\nlet socket = null;\n\nconst SOCKET_URL =\n  process.env.NODE_ENV === \"production\" ? \"/\" : \"http://localhost:5001\";\n\nexport function init(userinfo) {\n  socket = io(SOCKET_URL);\n  console.log(\"[socket] init\", SOCKET_URL);\n  socket.on(\"connect\", () => {\n    console.log(\"[socket] connect\");\n  });\n  if (socket && userinfo.id && userinfo.challenges) {\n    console.log(\"[socket] join\", userinfo.id, userinfo.challenges);\n    socket.emit(\"join\", userinfo);\n  }\n}\n\nexport function disconnect(roomId) {\n  if (!socket) return;\n  console.log(\"[socket] disconnect\", roomId);\n  socket.disconnect();\n}\n\nexport function sendMessage(message) {\n  if (!socket) return;\n  socket.emit(\"send_message\", message);\n}\n\nexport function receiveMessage(handler) {\n  console.log(\"[socket] receiveMessage\");\n  if (!socket) return;\n  socket.on(\"receive_message\", handler);\n}\n\nexport function blockMessage() {\n  if (!socket) return;\n  console.log(\"[socket] blockMessage\");\n  socket.off(\"receive_message\");\n}\n\nexport function emitAuthRequest(info) {\n  if (!socket) return;\n  console.log(\"[socket] emitAuthRequest\");\n  socket.emit(\"auth_request\", info);\n}\n\nexport function onAuthRequest(handler) {\n  if (!socket) return;\n  console.log(\"[socket] onAuthRequest\");\n  socket.on(\"auth_request\", handler);\n}\n\nexport function emitAuthApproval(info) {\n  if (!socket) return;\n  console.log(\"[socket] emitAuthApproval\");\n  socket.emit(\"auth_approval\", info);\n}\n\nexport function onAuthApproval(handler) {\n  if (!socket) return;\n  console.log(\"[socket] onAuthApproval\");\n  socket.on(\"auth_approval\", handler);\n}\n\n// TODO: 새로운 챌린지 참가, 졸업, 타이머에 의해 죽었을 때 처리\nexport function emitJoin(userinfo) {\n  if (!socket) return;\n  socket.emit(\"join_challenge\", userinfo);\n}\nexport function onJoin(handler) {\n  if (!socket) return;\n  socket.on(\"join_challenge\", handler);\n}\nexport function emitGraduate(userinfo) {\n  if (!socket) return;\n  socket.emit(\"graduate_challenge\", userinfo);\n}\nexport function onGraduate(handler) {\n  if (!socket) return;\n  socket.on(\"graduate_challenge\", handler);\n}\n\n// // // // // // // // // // // // // // // // // // // //\n// // // // // // // to update // // // // // // // // // //\n\nexport function usersOnRoom(handler) {\n  if (!socket) return;\n  console.log(\"[socket] usersOnRoom\");\n  socket.on(\"usersOnRoom\", handler);\n}\n"]},"metadata":{},"sourceType":"module"}