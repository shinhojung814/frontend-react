{"ast":null,"code":"var _jsxFileName = \"/Users/shinhojung/git/raising-alien-creatures/client/src/components/Canvas/index.js\";\nimport React, { Component } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default class Canvas extends Component {\n  constructor(props) {\n    super(props);\n\n    this.resizeEventHandler = event => {\n      // console.log(\"canvas, resizeEventHandler\");\n      this._cvs.width = window.innerWidth || document.body.clientWidth;\n      this._cvs.height = window.innerHeight || document.body.clientHeight;\n    };\n\n    this.mousemoveEventHandler = event => {\n      // console.log(\"canvas, mousemove\");\n      this.setMouseLocal(event);\n      this.mouseObj.isMouseMoving = true;\n    };\n\n    this.clickEventHandler = event => {\n      // console.log(\"canvas, mouse click\");\n      this.setMouseLocal(event);\n      this.mouseObj.clicked = true;\n      this.mouseObj.clickedFrame = this._frameCnt;\n    };\n\n    this.resetMouseObj = () => {\n      this.mouseObj.isMouseMoving = false;\n      this.mouseObj.clicked = false;\n      this.mouseObj.clickedFrame = undefined;\n    };\n\n    this.setMouseLocal = event => {\n      // https://stackoverflow.com/questions/17130395/real-mouse-position-in-canvas\n      let rect = this._cvs.getBoundingClientRect();\n\n      let borderWidth = 0; // temp\n\n      let scaleX = this._cvs.width / (rect.width - borderWidth * 2);\n      let scaleY = this._cvs.height / (rect.height - borderWidth * 2);\n      let mouseX = (event.clientX - (rect.left + borderWidth)) * scaleX;\n      let mouseY = (event.clientY - (rect.top + borderWidth)) * scaleY;\n      let padding = 10;\n      let isMouseOverCanvas = mouseX >= padding && mouseX <= this._cvs.width - padding && mouseY >= padding && mouseY <= this._cvs.height - padding;\n      this.mouseObj.mouseX = mouseX;\n      this.mouseObj.mouseY = mouseY;\n      this.mouseObj.isMouseOverCanvas = isMouseOverCanvas;\n      this.mouseObj.deltaXfromCenter = mouseX - this._cvs.width / 2;\n      this.mouseObj.deltaYfromCenter = mouseY - this._cvs.height / 2;\n      return {\n        mouseX,\n        mouseY,\n        isMouseOverCanvas\n      };\n    };\n\n    this.loop = () => {\n      this._frameCnt += 1;\n      let {\n        draw,\n        isLooped = true\n      } = this.props;\n      draw(this._ctx, this._frameCnt, this.mouseObj);\n      this.resetMouseObj();\n\n      if (isLooped) {\n        this._frameId = window.requestAnimationFrame(this.loop);\n      }\n    };\n\n    this.canvasRef = /*#__PURE__*/React.createRef();\n    this.mouseObj = {\n      mouseX: undefined,\n      mouseY: undefined,\n      isMouseOverCanvas: false,\n      isMouseMoving: false,\n      clicked: false,\n      clickedFrame: undefined\n    };\n  }\n\n  componentDidMount() {\n    if (!this._frameId) {\n      // initiate properties\n      this._cvs = this.canvasRef.current;\n      this._ctx = this._cvs.getContext(\"2d\");\n      this._frameCnt = 0;\n\n      this._cvs.addEventListener(\"click\", this.clickEventHandler); // start loop\n      // console.log(\"start loop\");\n\n\n      this.loop();\n    }\n\n    window.addEventListener(\"resize\", this.resizeEventHandler);\n    this.resizeEventHandler();\n    document.addEventListener(\"mousemove\", this.mousemoveEventHandler);\n  }\n\n  componentWillUnmount() {\n    // console.log(\"cancel loop\");\n    window.cancelAnimationFrame(this._frameId);\n    window.removeEventListener(\"resize\", this.resizeEventHandler);\n    document.removeEventListener(\"mousemove\", this.mousemoveEventHandler);\n\n    if (this._cvs) {\n      this._cvs.removeEventListener(\"click\", this.clickEventHandler);\n    }\n  }\n\n  render() {\n    let {\n      width = 300,\n      height = 300\n    } = this.props;\n    return /*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: this.canvasRef,\n      width: width,\n      height: height,\n      style: {\n        display: \"block\" // border: \"1px solid black\"\n\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 7\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["/Users/shinhojung/git/raising-alien-creatures/client/src/components/Canvas/index.js"],"names":["React","Component","Canvas","constructor","props","resizeEventHandler","event","_cvs","width","window","innerWidth","document","body","clientWidth","height","innerHeight","clientHeight","mousemoveEventHandler","setMouseLocal","mouseObj","isMouseMoving","clickEventHandler","clicked","clickedFrame","_frameCnt","resetMouseObj","undefined","rect","getBoundingClientRect","borderWidth","scaleX","scaleY","mouseX","clientX","left","mouseY","clientY","top","padding","isMouseOverCanvas","deltaXfromCenter","deltaYfromCenter","loop","draw","isLooped","_ctx","_frameId","requestAnimationFrame","canvasRef","createRef","componentDidMount","current","getContext","addEventListener","componentWillUnmount","cancelAnimationFrame","removeEventListener","render","display"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\n\nexport default class Canvas extends Component {\n  constructor(props) {\n    super(props);\n    this.canvasRef = React.createRef();\n    this.mouseObj = {\n      mouseX: undefined,\n      mouseY: undefined,\n      isMouseOverCanvas: false,\n      isMouseMoving: false,\n      clicked: false,\n      clickedFrame: undefined,\n    };\n  }\n\n  componentDidMount() {\n    if (!this._frameId) {\n      // initiate properties\n      this._cvs = this.canvasRef.current;\n      this._ctx = this._cvs.getContext(\"2d\");\n      this._frameCnt = 0;\n      this._cvs.addEventListener(\"click\", this.clickEventHandler);\n      // start loop\n      // console.log(\"start loop\");\n      this.loop();\n    }\n    window.addEventListener(\"resize\", this.resizeEventHandler);\n    this.resizeEventHandler();\n    document.addEventListener(\"mousemove\", this.mousemoveEventHandler);\n  }\n\n  componentWillUnmount() {\n    // console.log(\"cancel loop\");\n    window.cancelAnimationFrame(this._frameId);\n    window.removeEventListener(\"resize\", this.resizeEventHandler);\n    document.removeEventListener(\"mousemove\", this.mousemoveEventHandler);\n    if (this._cvs) {\n      this._cvs.removeEventListener(\"click\", this.clickEventHandler);\n    }\n  }\n\n  resizeEventHandler = (event) => {\n    // console.log(\"canvas, resizeEventHandler\");\n    this._cvs.width = window.innerWidth || document.body.clientWidth;\n    this._cvs.height = window.innerHeight || document.body.clientHeight;\n  };\n\n  mousemoveEventHandler = (event) => {\n    // console.log(\"canvas, mousemove\");\n    this.setMouseLocal(event);\n    this.mouseObj.isMouseMoving = true;\n  };\n\n  clickEventHandler = (event) => {\n    // console.log(\"canvas, mouse click\");\n    this.setMouseLocal(event);\n    this.mouseObj.clicked = true;\n    this.mouseObj.clickedFrame = this._frameCnt;\n  };\n\n  resetMouseObj = () => {\n    this.mouseObj.isMouseMoving = false;\n    this.mouseObj.clicked = false;\n    this.mouseObj.clickedFrame = undefined;\n  };\n\n  setMouseLocal = (event) => {\n    // https://stackoverflow.com/questions/17130395/real-mouse-position-in-canvas\n    let rect = this._cvs.getBoundingClientRect();\n    let borderWidth = 0; // temp\n\n    let scaleX = this._cvs.width / (rect.width - borderWidth * 2);\n    let scaleY = this._cvs.height / (rect.height - borderWidth * 2);\n\n    let mouseX = (event.clientX - (rect.left + borderWidth)) * scaleX;\n    let mouseY = (event.clientY - (rect.top + borderWidth)) * scaleY;\n\n    let padding = 10;\n    let isMouseOverCanvas =\n      mouseX >= padding &&\n      mouseX <= this._cvs.width - padding &&\n      mouseY >= padding &&\n      mouseY <= this._cvs.height - padding;\n\n    this.mouseObj.mouseX = mouseX;\n    this.mouseObj.mouseY = mouseY;\n    this.mouseObj.isMouseOverCanvas = isMouseOverCanvas;\n\n    this.mouseObj.deltaXfromCenter = mouseX - this._cvs.width / 2;\n    this.mouseObj.deltaYfromCenter = mouseY - this._cvs.height / 2;\n\n    return {\n      mouseX,\n      mouseY,\n      isMouseOverCanvas,\n    };\n  };\n\n  loop = () => {\n    this._frameCnt += 1;\n    let { draw, isLooped = true } = this.props;\n    draw(this._ctx, this._frameCnt, this.mouseObj);\n    this.resetMouseObj();\n    if (isLooped) {\n      this._frameId = window.requestAnimationFrame(this.loop);\n    }\n  };\n\n  render() {\n    let { width = 300, height = 300 } = this.props;\n    return (\n      <canvas\n        ref={this.canvasRef}\n        width={width}\n        height={height}\n        style={{\n          display: \"block\",\n          // border: \"1px solid black\"\n        }}\n      />\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}